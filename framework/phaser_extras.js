/*! For license information please see phaser_extras.js.LICENSE.txt */
class PhaserExtras{clear(){const e=document.getElementsByTagName("canvas");if(e)for(const t of e)t.style&&"none"==t.style.touchAction&&"none"==t.style.userSelect&&t.remove();document.getElementById("ghostery-tracker-tally")?.remove(),document.getElementById("ghostery-box")?.remove(),document.getElementById("ghostery-pb-background")?.remove()}static addGroupSprite(e,t,a,n,o,r){const s=e.add.sprite(t,a,n);o&&o.add(s),e.physics.arcade.enable(s),s.checkWorldBounds=!0,s.outOfBoundsKill=!0,s.z=100,r&&"function"==typeof r&&r(s)}static VerticalObstacleGenerator(e,t,a,n,o,r,s,i,c,h){const d=PhaserExtras.getSpriteSize(e,r,h),l=e.rnd.integerInRange(0,n-o-1);for(let g=0;g<n;g++)if(g<l||g>=l+o){let n=r;g==l+o&&i?n=i:g==l-1&&s&&(n=s),PhaserExtras.addGroupSprite(e,t,a+g*d.height,n,c,h)}}static RandomVerticalObstacleGenerator(e,t,a,n,o,r,s,i,c){const h=PhaserExtras.getSpriteSize(e,o,c),d=e.rnd.integerInRange(0,n);"top"===i&&(a-=h.height);for(let n=1;n<=d;n++)"top"===i?PhaserExtras.addGroupSprite(e,t,a+n*h.height,r&&n===d?r:o,s,c):PhaserExtras.addGroupSprite(e,t,a-n*h.height,r&&n===d?r:o,s,c)}static MatrixBlockGenerator(e,t,a,n=0,o=0,r=10,s,i){let c=0;const h=PhaserExtras.getSpriteSize(e,t,i);for(let d=0;d<=7;d++)for(let l=0;l<=7;l++)if(a[c++]){const a=l*(h.width+r)+n,c=d*(h.height+r)+o;PhaserExtras.addGroupSprite(e,a,c,t,s,i)}}static getSpriteSize(e,t,a){let n=e.cache.getImage(t).width,o=e.cache.getImage(t).width;if(a){const r=e.add.sprite(0,0,t);e.physics.arcade.enable(r),r.visible=!1,a(r),n=r.width,o=r.height,r.destroy()}return{width:n,height:o}}static takeScreenshot(e){let t=e.canvas.width,a=e.canvas.height;t/a>270/152?(t=270,a=t/e.canvas.width*e.canvas.height):(a=152,t=a/e.canvas.height*e.canvas.width);const n=document.createElement("canvas");n.width=270,n.height=152;const o=n.getContext("2d");return o.fillStyle="rgba(0, 0, 0, 0)",o.fillRect(0,0,n.width,n.height),o.drawImage(e.canvas,0,0,e.canvas.width,e.canvas.height,(270-t)/2,(152-a)/2,t,a),n.toDataURL()}static showScreenshot(e){const t=new Image;t.src=PhaserExtras.takeScreenshot(e);window.open("").document.write(t.outerHTML)}static sendScreenshot(e){const t=PhaserExtras.takeScreenshot(e);t&&window.parent&&window.parent.postMessage({type:"screenshot",value:t},`${window.location.protocol}//${window.location.hostname}:${window.location.port}`)}}document.addEventListener("DOMContentLoaded",(function(){(new PhaserExtras).clear()})),window.location.pathname.endsWith("/screenshot")&&window.addEventListener("load",(function(){window.setTimeout((()=>{PhaserExtras.sendScreenshot(window.game)}),500)}));